// å¤šè¯­è¨€æ”¯æŒç³»ç»Ÿ
const translations = {
    zh: {
        nav_portfolio: "æˆ‘çš„ä½œå“é›†",
        loading_text: "åŠ è½½ä¸­...",
        nav_home: "é¦–é¡µ",
        nav_about: "å…³äºæˆ‘",
        nav_projects: "é¡¹ç›®",
        nav_contact: "è”ç³»",
        
        hero_title: "ä½ å¥½ï¼Œæˆ‘æ˜¯Alex Chen",
        hero_subtitle: "ä¸€åå……æ»¡æ¿€æƒ…çš„å…¨æ ˆå¼€å‘è€…ï¼Œä¸“æ³¨äºåˆ›é€ ä¼˜é›…ä¸”é«˜æ•ˆçš„æ•°å­—è§£å†³æ–¹æ¡ˆ",
        hero_cta: "æŸ¥çœ‹æˆ‘çš„ä½œå“",
        
        about_title: "å…³äºæˆ‘",
        about_role: "å…¨æ ˆå¼€å‘è€…",
        about_description: "æˆ‘æ˜¯ä¸€åå……æ»¡æ¿€æƒ…çš„å…¨æ ˆå¼€å‘è€…ï¼Œæ‹¥æœ‰5å¹´çš„Webå¼€å‘ç»éªŒã€‚æˆ‘ä¸“æ³¨äºåˆ›å»ºç”¨æˆ·å‹å¥½ä¸”é«˜æ•ˆçš„æ•°å­—è§£å†³æ–¹æ¡ˆã€‚",
        about_education1: "è®¡ç®—æœºç§‘å­¦å­¦å£«å­¦ä½",
        about_education2: "æ¸…åå¤§å­¦",
        about_experience1: "5å¹´Webå¼€å‘ç»éªŒ",
        about_experience2: "å¤šä¸ªæˆåŠŸé¡¹ç›®",
        about_achievement1: "React & Node.jsä¸“å®¶",
        about_achievement2: "UI/UXè®¾è®¡ç»éªŒ",
        about_achievement3: "æ•æ·å¼€å‘æ–¹æ³•",
        about_achievement4: "å›¢é˜Ÿåä½œ",
        
        projects_title: "æˆ‘çš„é¡¹ç›®",
        project_title1: "ç”µå•†å¹³å°",
        project_desc1: "ä¸€ä¸ªåŠŸèƒ½é½å…¨çš„ç”µå•†å¹³å°ï¼Œå…·æœ‰ç”¨æˆ·è®¤è¯ã€äº§å“ç®¡ç†å’Œæ”¯ä»˜é›†æˆç­‰åŠŸèƒ½",
        project_title2: "ä»»åŠ¡ç®¡ç†åº”ç”¨",
        project_desc2: "ä¸€ä¸ªåä½œå¼ä»»åŠ¡ç®¡ç†å·¥å…·ï¼Œå¸®åŠ©å›¢é˜Ÿæé«˜å·¥ä½œæ•ˆç‡å’Œç»„ç»‡èƒ½åŠ›",
        project_title3: "å¤©æ°”ä»ªè¡¨æ¿",
        project_desc3: "ä¸€ä¸ªå®æ—¶å¤©æ°”ç›‘æ§åº”ç”¨ï¼Œå…·æœ‰äº¤äº’å¼å›¾è¡¨å’ŒåŸºäºä½ç½®çš„æœåŠ¡",
        project_demo: "æŸ¥çœ‹æ¼”ç¤º",
        project_code: "æŸ¥çœ‹ä»£ç ",
        
        contact_title: "è”ç³»æˆ‘",
        contact_subtitle: "è®©æˆ‘ä»¬ä¸€èµ·åˆä½œ",
        contact_description: "æœ‰é¡¹ç›®æƒ³æ³•æˆ–æƒ³è®¨è®ºåˆä½œæœºä¼šï¼Ÿæˆ‘å¾ˆä¹æ„å¬å–æ‚¨çš„æ„è§ã€‚",
        contact_quick: "å¿«é€Ÿè”ç³»",
        contact_website: "ä¸ªäººç½‘é¡µ",
        contact_email: "é‚®ç®±",
        contact_form_title: "å‘é€æ¶ˆæ¯",
        contact_name: "å§“å",
        contact_email_field: "é‚®ç®±",
        contact_subject: "ä¸»é¢˜",
        contact_message: "ç•™è¨€",
        contact_submit: "å‘é€æ¶ˆæ¯",
        contact_placeholder_name: "æ‚¨çš„å§“å",
        contact_placeholder_email: "æ‚¨çš„é‚®ç®±åœ°å€",
        contact_placeholder_subject: "æ¶ˆæ¯ä¸»é¢˜",
        contact_placeholder_message: "æ‚¨çš„ç•™è¨€",
        
        footer_copyright: "Â© 2024 æˆ‘çš„ä½œå“é›†. ä¿ç•™æ‰€æœ‰æƒåˆ©ã€‚"
    },
    en: {
        nav_portfolio: "My Portfolio",
        loading_text: "Loading...",
        nav_home: "Home",
        nav_about: "About Me",
        nav_projects: "Projects",
        nav_contact: "Contact",
        
        hero_title: "Hi, I'm Alex Chen",
        hero_subtitle: "A passionate full-stack developer focused on creating elegant and efficient digital solutions",
        hero_cta: "View My Work",
        
        about_title: "About Me",
        about_role: "Full Stack Developer",
        about_description: "I'm a passionate full-stack developer with 5 years of experience in web development. I specialize in creating user-friendly and efficient digital solutions.",
        about_education1: "Bachelor's Degree in Computer Science",
        about_education2: "Tsinghua University",
        about_experience1: "5 Years of Web Development",
        about_experience2: "Multiple Successful Projects",
        about_achievement1: "React & Node.js Expert",
        about_achievement2: "UI/UX Design Experience",
        about_achievement3: "Agile Development Methods",
        about_achievement4: "Team Collaboration",
        
        projects_title: "My Projects",
        project_title1: "E-commerce Platform",
        project_desc1: "A full-featured e-commerce platform with user authentication, product management, and payment integration",
        project_title2: "Task Management App",
        project_desc2: "A collaborative task management tool that helps teams improve productivity and organization",
        project_title3: "Weather Dashboard",
        project_desc3: "A real-time weather monitoring application with interactive charts and location-based services",
        project_demo: "View Demo",
        project_code: "View Code",
        
        contact_title: "Contact Me",
        contact_subtitle: "Let's Work Together",
        contact_description: "Have a project idea or want to discuss collaboration opportunities? I'd love to hear from you.",
        contact_quick: "Quick Contact",
        contact_website: "Personal Website",
        contact_email: "Email",
        contact_form_title: "Send Message",
        contact_name: "Name",
        contact_email_field: "Email",
        contact_subject: "Subject",
        contact_message: "Message",
        contact_submit: "Send Message",
        contact_placeholder_name: "Your Name",
        contact_placeholder_email: "Your Email Address",
        contact_placeholder_subject: "Message Subject",
        contact_placeholder_message: "Your Message",
        
        footer_copyright: "Â© 2024 My Portfolio. All rights reserved."
    }
};

// å½“å‰è¯­è¨€
let currentLanguage = 'zh';

// åˆ‡æ¢è¯­è¨€
function switchLanguage(lang) {
    if (lang === currentLanguage) {
        return;
    }
    
    currentLanguage = lang;
    
    // æ›´æ–°HTML langå±æ€§
    document.documentElement.lang = lang;
    
    // æ›´æ–°æ‰€æœ‰å¸¦æœ‰data-i18nå±æ€§çš„å…ƒç´ 
    const elements = document.querySelectorAll('[data-i18n]');
    elements.forEach(element => {
        const key = element.getAttribute('data-i18n');
        if (translations[lang] && translations[lang][key]) {
            element.textContent = translations[lang][key];
        }
    });
    
    // æ›´æ–°å ä½ç¬¦
    const placeholderElements = document.querySelectorAll('[data-i18n-placeholder]');
    placeholderElements.forEach(element => {
        const key = element.getAttribute('data-i18n-placeholder');
        if (translations[lang] && translations[lang][key]) {
            element.placeholder = translations[lang][key];
        }
    });
    
    // æ›´æ–°é¡µé¢æ ‡é¢˜
    const pageTitle = document.querySelector('title');
    if (pageTitle) {
        pageTitle.textContent = lang === 'en' ? 'My Portfolio' : 'æˆ‘çš„ä½œå“é›†';
    }
    
    // æ›´æ–°å¯¼èˆªlogo
    const navLogo = document.querySelector('.nav-logo h1');
    if (navLogo) {
        navLogo.textContent = lang === 'en' ? 'My Portfolio' : 'æˆ‘çš„ä½œå“é›†';
    }
    
    // æ›´æ–°meta description
    const metaDesc = document.querySelector('meta[name="description"]');
    if (metaDesc) {
        metaDesc.content = lang === 'en' 
            ? 'Personal portfolio website - showcasing my projects and skills' 
            : 'ä¸ªäººä½œå“é›†ç½‘ç«™ - å±•ç¤ºæˆ‘çš„é¡¹ç›®å’ŒæŠ€èƒ½';
    }
    
    // æ›´æ–°è¯­è¨€åˆ‡æ¢æŒ‰é’®çŠ¶æ€
    updateLanguageButtons();
    
    // ä¿å­˜è¯­è¨€åå¥½åˆ°localStorage
    localStorage.setItem('preferredLanguage', lang);
}

// æ›´æ–°è¯­è¨€åˆ‡æ¢æŒ‰é’®çŠ¶æ€
function updateLanguageButtons() {
    const langButtons = document.querySelectorAll('.lang-btn');
    langButtons.forEach(button => {
        if (button.getAttribute('data-lang') === currentLanguage) {
            button.classList.add('active');
        } else {
            button.classList.remove('active');
        }
    });
}

// åˆå§‹åŒ–è¯­è¨€
function initLanguage() {
    // æ£€æŸ¥localStorageä¸­çš„è¯­è¨€åå¥½
    const savedLang = localStorage.getItem('preferredLanguage');
    
    if (savedLang && translations[savedLang]) {
        currentLanguage = savedLang;
    } else {
        // æ£€æµ‹æµè§ˆå™¨è¯­è¨€
        const browserLang = navigator.language || navigator.userLanguage;
        if (browserLang.startsWith('zh')) {
            currentLanguage = 'zh';
        } else {
            currentLanguage = 'en';
        }
    }
    
    switchLanguage(currentLanguage);
}

// ç»‘å®šè¯­è¨€åˆ‡æ¢æŒ‰é’®äº‹ä»¶
function bindLanguageButtons() {
    const langButtons = document.querySelectorAll('.lang-btn');
    langButtons.forEach(button => {
        // ç§»é™¤ä¹‹å‰çš„äº‹ä»¶ç›‘å¬å™¨ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
        button.removeEventListener('click', handleLanguageClick);
        // æ·»åŠ æ–°çš„äº‹ä»¶ç›‘å¬å™¨
        button.addEventListener('click', handleLanguageClick);
    });
}

// å¤„ç†è¯­è¨€æŒ‰é’®ç‚¹å‡»çš„ç‹¬ç«‹å‡½æ•°
function handleLanguageClick() {
    const lang = this.getAttribute('data-lang');
    if (lang) {
        switchLanguage(lang);
    }
}

// ä¸»é¢˜åˆ‡æ¢åŠŸèƒ½
function initTheme() {
    const themeToggle = document.getElementById('theme-toggle');
    if (!themeToggle) return;
    
    // æ£€æŸ¥æœ¬åœ°å­˜å‚¨çš„ä¸»é¢˜è®¾ç½®
    const savedTheme = localStorage.getItem('theme');
    if (savedTheme === 'dark') {
        document.body.classList.add('dark-mode');
        updateThemeIcon(true);
    }
    
    // ç»‘å®šä¸»é¢˜åˆ‡æ¢äº‹ä»¶
    themeToggle.addEventListener('click', function() {
        const isDark = document.body.classList.toggle('dark-mode');
        localStorage.setItem('theme', isDark ? 'dark' : 'light');
        updateThemeIcon(isDark);
    });
}

// æ›´æ–°ä¸»é¢˜å›¾æ ‡
function updateThemeIcon(isDark) {
    const themeIcon = document.querySelector('.theme-icon');
    if (themeIcon) {
        themeIcon.textContent = isDark ? 'â˜€ï¸' : 'ğŸŒ™';
    }
}

// é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
function initializeApp() {
    initLanguage();
    bindLanguageButtons();
    initTheme();
}

// ç¡®ä¿åœ¨DOMåŠ è½½å®Œæˆååˆå§‹åŒ–
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initializeApp);
} else {
    initializeApp();
}

// å¯¼å‡ºå‡½æ•°ä¾›å…¨å±€ä½¿ç”¨
window.switchLanguage = switchLanguage;

// é¢å¤–ç¡®ä¿è¯­è¨€æŒ‰é’®ç»‘å®šäº‹ä»¶ï¼ˆå¤„ç†å¯èƒ½çš„æ—¶åºé—®é¢˜ï¼‰
document.addEventListener('DOMContentLoaded', function() {
    // å»¶è¿Ÿä¸€ç‚¹å†ç»‘å®šï¼Œç¡®ä¿æ‰€æœ‰å…ƒç´ éƒ½å·²åŠ è½½
    setTimeout(bindLanguageButtons, 100);
});